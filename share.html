<!DOCTYPE html>
<html>
<head>
  <title>Share</title>
  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <script src="js/share.js"></script>
</head>
<body>
    <script>
      let screen;
      const showScreen = (text) => {
        if (!screen) {
          screen = document.querySelector('#screen');
        }
        screen.innerHTML = text;
      }

      const shareImg = async () => {
        showScreen('Start sharing...')
        if (!navigator.share) {
          showScreen('Share not supported');
          return;
        }
        try {
          // Using a CORS-enabled image service or local image
          // Option 1: Use a CORS-enabled CDN
          const url = 'https://yandex-images.clstorage.net/T95So4C01/ad0082WsOau1/AEHCk4wb4x91E68FP6YTHy17e8Ow9UIGKjvhS1uQbomRkHAJF8evJkv6ji_oYUnG4fltwDB2kT2aUeAFjdyfgFQEpicsK6OOUYJuIQ6mw8sduh7nULG3Joo-xE3t5xyL9-K2btAwOKK7v056idCZUjJqrMcFsNIoDvEQkSn4K3eBcxGT6anzHpOw32U-9-Pp_0hrlRFAkNU_akOvbCSPGJSSZXwiIAlR2r7PumgVWSMTGXmlBwChin1TcUAICtvEkxBRUhibUt0Aww1F_zbQe__L25YggpJ17_kjbk8XfkpUUoTdMsDr0qivDqoJxFsQE-oYJiZw0zv-4VPhe_sJx4PTYdM7e6Ov46B-tazVUbvtSGrFAJMgd_2rkb9OlV5LFHL1rvIwOtGYzQ-qeJZrIdMZCIVF8qDpX7CAkji7SCfz4nNySjpCzxKgTzVel2A6nPtoF2Lwg6RfKaIvjuR8WZVzN-zC8ElQGT2MynklCMEwyGiUV2FTy9xwoJBKeopXQ9BA0SjosR_jcG10zTXBqo44e6fTAfJ3bLpBToxnvEtlUveuUuHrM4sNvnppFRhxYzvrRiUDMGqtwvFj-Yk7peOw0fKK6eHs4NEdhY9mEgqOuwsE0eGQBPzpo7ycZKwotQEnbNCz6oE4LJ27WvRK8_HLmtZlsrIIr_BS0_v7eodzIbExqlmDTRPBrHTspPKprSpoJ5EBoaU9OZFeDufd2veCx58TQlnBy30-GhkmK_EBqRlVF8CCC-xS0PP7mVo1MKDSMai4EPwTc5xXX4aBqo9JeOZgMFKGHKmwLk72POklkyWcwgMJEcjdb2rJNNjDwtuYd3dQQZmtoLPxaOl6dDEgcVEq6EFMUsN8RU-l4em8mKhnECERB184sx6flYxZNNA1beCQ-oHqrZ8JmcQqopNZi6Qn8sLqfwDh45iJ63RTEfNRKhog3uNRDXb_lHJ6vqto55FygKQvO_NvY';
          const response = await fetch(url, {
            mode: 'cors'
          });
          
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          
          showScreen(`Get blob: ${response.status}`);
          const blob = await response.blob();
          showScreen(`Share blob...`);
          // Для iOS лучше передать imageUrl напрямую, так как files не поддерживается
          await shareImageAsset({
            blobImageAsset: blob,
            title: 'Share Image',
            text: 'Check out this image!',
            url: window.location.href,
            imageUrl: url // Используем оригинальный URL изображения для iOS
          });
          showScreen('End sharing.')
        } catch (error) {
          console.error('Failed to fetch image:', error);
          showScreen('Failed to load image. Please check your internet connection or try again.');
        }
      }
  </script>
  <div id="screen"></div>
  <button onclick="shareImg()">Share</button>
</body>
</html>
